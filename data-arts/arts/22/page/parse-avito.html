<h3>Бизнес-идея</h3>
<p>
    Из-за отстуствия стабильности в доходах я решил попробовать заработать на перепродаже компьютерной техники,
    но открывать браузером вручную доски объявлений в интернете и выбирать на страницах подходящие объявления мне
    показалось скучным и неинтересным. Так возникла идея автоматического парсинга объявлений.
</p>
<p>
    Для начала я решил разобрать avito.ru. Изучив структуру сайта стало понятной следующее:
<ol>
    <li>Все новые объявления появляются на главной странице в соотвествующей категории
        <ul>
            <li><a href='https://www.avito.ru/ivanovo/noutbuki' style='word-wrap: break-word;'>https://www.avito.ru/ivanovo/noutbuki</a></li>
            <li><a href='https://www.avito.ru/ivanovo/planshety_i_elektronnye_knigi' style='word-wrap: break-word;'>https://www.avito.ru/ivanovo/planshety_i_elektronnye_knigi</a></li>
            <li><a href='https://www.avito.ru/ivanovo/telefony' style='word-wrap: break-word;'>https://www.avito.ru/ivanovo/telefony</a></li>
        </ul>
        , значит мне надо парсить именно эти страницы.
    </li>
    <li>Каждое объявление имеет свой уникальный адрес url, таким образом можно решить проблему повторов при следующем
        переобходе страницы категории</li>
    <li>Ссылку на url, заголовок, цену и компанию продавца можно получить распарсив страницу с категорией, а вот чтобы
        получить описание товара и продавца надо еще обойти и распарсить страницу объявления.</li>
</ol>
</p>
<h3>Реализация</h3>
<p>
    Структура страницы avito оказалась понятной, написать скрипт парсинга не заняло много времени.
    По <a href='/data-arts/arts/22/parse-avito.php.txt' target="_blank">ссылке</a> можно посмотреть отрывок,
    как может быть реализован парсинг авито на php. При этом в скрипте используются самые простые фунции php
    <strong>file_get_contents</strong>, <strong>str_ps</strong>, <strong>substr</strong>, и нет регулярных выражений или
    curl.
</p>
Алгоритм работы скрипта заключается в непрерывном (пока не закончится страница) поиске тегов-заголовков объявлений в html-коде
страницы категории. В теле объявления присутствую теги цены, компании и ссылки на объявление, которые парсятся как показано в примере.
Для получения описания и продавца в цикле загружается парсится страница объявления.
<p>
    Далее я решил протестировать скрипт. Как оказалось, если за один проход скрипта загружать большое количество страниц с
    описанием avito выкинент ошибку как на рисунке с просьбой пройти каптчу.
<div class="example-img"><img src="/data-arts/arts/22/img/accessDenied.jpg" style="width: 50%">
    <span>avito.ru блокирует ip-адрес когда за раз загружается большое количество объявлений</span>
</div>
Для этого в скрипте установлены ограничения:
<b>MAX_SUSS_CNT</b>,
<b>MAX_STOTAL_CNT</b>. В результате работы скрипт выведет текст объявлений - ассоциативный массив <b>$parseRD</b> и
логи работы - ассоциативный массив <b>$parseLog</b>. В случае ошибок скрипт сохранит проблемную страницу в папке
$_SERVER["DOCUMENT_ROOT"] . "/parse-avito
</p>
<h3>Результаты</h3>
<p>
    Результаты работы скрипта вы можете <a href='/parse-ad'>посмотреть на этом сайте</a>
</p>
<p>
    Примерно за месяц работы скрипт распарсил 8165 объявлений, из них:
<ul>
    <li>Частные - 5672</li>
    <li>Компании и магазины - 2493</li>
</ul>
<ul><li>Ноутбуки - 1603</li><li>Планшеты - 762</li><li>Телефоны - 5800</li></ul>
</p>
<h3>Выводы</h3>
<p>Меня больше интересовали ноутбуки и даже попадались реальные предложения, но таких было мало 3-5 за месяц.
    Как раз в эту категорию магазины и компании подавали объявления чаще всего, частных объявлений них было только 538</p>
<p>Часто частные продавцы работали как магазины и у них было по 10 и более открытых объявлений. Очень часто продавали
ноутбуки по магазинным ценам и иногда выше, писали что ноут игровой и т.п.</p>
<p>
    В итоге я решил отказаться от идеи заработать на перекупе, возможно в другой категории (автомобили или недвижимость)
    дела обстоят лучше, но это не моя область.
</p>
<p>
<strong>Преимущества парсинга</strong>
<ul>
    <li>Просматривать распарсенные объявления гораздо удобней чем на самом avito, страница без картинок и рекламы
        загружается быстрее</li>
    <li>Объявления сортируются попорядку убывания даты (новые сверху), а не идут вперемешку как на самом avito, где
    наверх поднимаются проплаченные</li>
    <li>Легко улучшить скрипт, нет необходимости самому просматривать доски, можно настроить оповещение на e-mail
        при наличии новых объявлений, включить в скрипт дополнительные фильтры</li>
</ul>
</p>
<strong>Если вас интересуют парсеры досок объявлений, вы можете заказать написание парсера по
    <a href='/status'>по телефону или e-mail</a></strong>