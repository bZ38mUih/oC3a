<h3>Идея</h3>
<p>
    Из-за отстуствия стабильности в доходах я решил попробовать заработать на перепродаже компьютерной техники,
    но открывать браузером вручную страницы досок объявлений в интернете и искать на с них подходящие мне показалось
    скучным и неинтересным. Так возникла идея автоматического парсинга объявлений.
</p>
<p>
    Для начала я решил разобрать avito.ru. Изучив структуру сайта стало понятной следующее:
<ol>
    <li>Все новые объявления появляются на главной странице в соотвествующей категории
        <ul>
            <li><a href='https://www.avito.ru/ivanovo/noutbuki'>https://www.avito.ru/ivanovo/noutbuki</a></li>
            <li><a href='https://www.avito.ru/ivanovo/planshety_i_elektronnye_knigi'>https://www.avito.ru/ivanovo/planshety_i_elektronnye_knigi</a></li>
            <li><a href='https://www.avito.ru/ivanovo/telefony'>https://www.avito.ru/ivanovo/telefony</a></li>
        </ul>
        , значит мне надо парсить именно эти страницы
    </li>
    <li>Каждое объявление имеет свой уникальный адрес uri, таким образом можно решить проблему повторов при следующем
        переобходе страницы категории</li>
    <li>Ссылку на uri, заголовок, цену и компанию объявления можно получить распарсив страницу с категорией, а вот чтобы
        получить описание товара и продавца надо еще обойти и распарсить страницу с описанием.</li>
</ol>
</p>
<h3>Реализация</h3>
<p>
    Структура страницы avito оказалась понятной, написать скрипт парсинга не заняло много времени, ниже приведен отрывок,
    как может быть реализован парсинг авито на php. При этом в скрипте используются самые простые фунции php
    <strong>file_get_contents</strong>, <strong>str_ps</strong>, <strong>substr</strong>, и нет регулярных выражений или
    curl.
</p>
<div class="example">
    my parse script here
</div>
Алгоритм работы скрипта заключается в непрерывном (пока не закончится страница) поиске тегов-заголовков объявлений в html-коде
страницы категории. В теле объявления присутствую теги цены, компании и ссылки на объявление, которые парсятся как показано выше.
Для получения описания и продавца в цикле загружается парсится страница с описанием товара.
<p>
    Далее я решил протестировать скрипт. Как оказалось, если за один проход скрипта загружать большое количество страниц с
    описанием avito выкинент ошибку как на рисунке с просьбой проити каптчу.
<div class="example-img"><img src="/data-arts/arts/2/img/warning.png" style="width: 50%">
    <span>avito.ru блокирует ip-адрес когда за раз загружается большое количество страниц</span>
</div>
Для этого в скрипте установлены ограничения:
<b>MAX_SUSS_CNT</b>
<b>MAX_STOTAL_CNT</b>
</p>
<h3>Результаты</h3>
<p>
    Результаты работы скрипта вы можете <a href='/pares-ad'>посмотреть на этом сайте</a>
</p>
<p>
    За 5 дней работы скрипт распарсил ... объявлений, из них:
    <ul><li>Ноутбуки - ...</li><li>Планшеты - ...</li><li>Телефоны - ...</li></ul>
</p>
<h3>Выводы</h3>
Чем хорош парсинг
<ul>
    <li>Просматривать распарсеные объявления гораздо удобней чем на самом avito, страница без картинок и рекламы
        загружается быстсрее</li>
    <li>Объявления сортируются попорядку убывания даты (новые сверху), а не идут вперемешку как на самом avito</li>
    <li>Легко улучшить скрипт, нет необходимости самому просматиравать доски, можно настроить оповещение на e-mail
    при наличии новых объяелений, включить в скрипт дополнительные фильтры отбора объявлений</li>
</ul>
Поскольку меня больше интересовали ноутбуки, за 5 дней я нашел 5 вариантов неплохих ноутов, к ценику которых
иможно смело приклеивать 25% и выставлять снова на доску. Это объявления от частных лиц, не жалающих ходить
к перекупам, продающих технику с целью добавить на покупку новой.
<ul>
    <li>Страница без картинок и рекламы загружется бытсрее</li>
    <li>Объявления сортируются попорядку убфвания даты (новые сверху), а не идут вперемешку как на самом avito</li>
</ul>
<strong>Если вас интересуют парсеры досок объявлений, вы можете заказать написание парсера по
    <a href='/status'>по телефону или e-mail</a></strong>